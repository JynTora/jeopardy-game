<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <title>Buzzer ‚Äì Jeopardy Teams</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <link rel="manifest" href="/manifest.json" />
    <script>if('serviceWorker' in navigator){navigator.serviceWorker.register('/sw.js');}</script>
    <link rel="stylesheet" href="/style.css" />
    <style>
      * { box-sizing: border-box; margin: 0; padding: 0; }

      html, body {
        height: 100%;
        overflow: hidden;
        touch-action: manipulation;
        -webkit-user-select: none;
        user-select: none;
      }

      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
        color: #f9fafb;
        display: flex;
        flex-direction: column;
      }

      /* Header */
      .buzzer-header {
        padding: 12px 16px;
        background: rgba(15, 23, 42, 0.9);
        border-bottom: 1px solid rgba(245, 158, 11, 0.3);
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-shrink: 0;
      }

      .player-info {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .team-badge {
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 0.7rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .team-badge.team-red { background: rgba(239, 68, 68, 0.3); color: #f87171; border: 1px solid rgba(239, 68, 68, 0.5); }
      .team-badge.team-blue { background: rgba(59, 130, 246, 0.3); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.5); }
      .team-badge.team-green { background: rgba(34, 197, 94, 0.3); color: #4ade80; border: 1px solid rgba(34, 197, 94, 0.5); }
      .team-badge.team-purple { background: rgba(168, 85, 247, 0.3); color: #c084fc; border: 1px solid rgba(168, 85, 247, 0.5); }
      .team-badge.team-orange { background: rgba(249, 115, 22, 0.3); color: #fb923c; border: 1px solid rgba(249, 115, 22, 0.5); }
      .team-badge.team-pink { background: rgba(236, 72, 153, 0.3); color: #f472b6; border: 1px solid rgba(236, 72, 153, 0.5); }

      .player-name {
        font-weight: 700;
        font-size: 1rem;
        color: #f8fafc;
      }

      .back-btn {
        padding: 8px 14px;
        border-radius: 8px;
        border: 1px solid rgba(148, 163, 184, 0.3);
        background: rgba(30, 41, 59, 0.8);
        color: #94a3b8;
        font-size: 0.8rem;
        cursor: pointer;
        transition: all 0.15s ease;
      }

      .back-btn:hover {
        background: rgba(51, 65, 85, 0.9);
        color: #f8fafc;
      }

      /* Main Buzzer Area */
      .buzzer-main {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        position: relative;
      }

      .buzzer-button {
        width: min(85vw, 85vh, 400px);
        height: min(85vw, 85vh, 400px);
        border-radius: 50%;
        border: none;
        cursor: pointer;
        position: relative;
        transition: transform 0.1s ease, box-shadow 0.2s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 8px;
        font-family: inherit;
        -webkit-tap-highlight-color: transparent;
      }

      .buzzer-button:active:not(:disabled) {
        transform: scale(0.95);
      }

      /* Buzzer States */
      .buzzer-button.buzzer-locked {
        background: linear-gradient(145deg, #dc2626, #991b1b);
        box-shadow: 
          0 0 60px rgba(220, 38, 38, 0.4),
          0 20px 60px rgba(0, 0, 0, 0.5),
          inset 0 -8px 30px rgba(0, 0, 0, 0.3),
          inset 0 8px 30px rgba(255, 255, 255, 0.1);
        cursor: not-allowed;
      }

      .buzzer-button.buzzer-free {
        background: linear-gradient(145deg, #22c55e, #15803d);
        box-shadow: 
          0 0 80px rgba(34, 197, 94, 0.5),
          0 20px 60px rgba(0, 0, 0, 0.5),
          inset 0 -8px 30px rgba(0, 0, 0, 0.3),
          inset 0 8px 30px rgba(255, 255, 255, 0.15);
        animation: pulse-glow 1.5s ease-in-out infinite;
      }

      .buzzer-button.buzzer-pressed {
        background: linear-gradient(145deg, #eab308, #ca8a04);
        box-shadow: 
          0 0 100px rgba(234, 179, 8, 0.6),
          0 20px 60px rgba(0, 0, 0, 0.5),
          inset 0 -8px 30px rgba(0, 0, 0, 0.3),
          inset 0 8px 30px rgba(255, 255, 255, 0.15);
        transform: scale(0.95);
      }

      @keyframes pulse-glow {
        0%, 100% { box-shadow: 0 0 60px rgba(34, 197, 94, 0.4), 0 20px 60px rgba(0, 0, 0, 0.5), inset 0 -8px 30px rgba(0, 0, 0, 0.3), inset 0 8px 30px rgba(255, 255, 255, 0.15); }
        50% { box-shadow: 0 0 100px rgba(34, 197, 94, 0.6), 0 20px 60px rgba(0, 0, 0, 0.5), inset 0 -8px 30px rgba(0, 0, 0, 0.3), inset 0 8px 30px rgba(255, 255, 255, 0.15); }
      }

      .buzzer-text {
        font-size: clamp(1.5rem, 8vw, 2.5rem);
        font-weight: 900;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: #fff;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .buzzer-subtext {
        font-size: clamp(0.8rem, 3vw, 1rem);
        font-weight: 600;
        color: rgba(255, 255, 255, 0.8);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      /* Status Bar */
      .status-bar {
        padding: 16px;
        background: rgba(15, 23, 42, 0.95);
        border-top: 1px solid rgba(245, 158, 11, 0.3);
        text-align: center;
        flex-shrink: 0;
      }

      .status-text {
        font-size: 0.9rem;
        color: #94a3b8;
      }

      .status-text.buzzed {
        color: #fbbf24;
        font-weight: 700;
      }

      /* Join Overlay */
      .join-overlay {
        position: fixed;
        inset: 0;
        background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        padding: 20px;
      }

      .join-overlay.hidden { display: none; }

      .join-card {
        background: rgba(30, 41, 59, 0.95);
        border: 2px solid rgba(245, 158, 11, 0.4);
        border-radius: 24px;
        padding: 32px;
        max-width: 400px;
        width: 100%;
        text-align: center;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
      }

      .join-title {
        font-size: 1.6rem;
        font-weight: 800;
        margin-bottom: 8px;
        color: #f8fafc;
      }

      .join-subtitle {
        font-size: 0.9rem;
        color: #94a3b8;
        margin-bottom: 24px;
      }

      .join-step {
        margin-bottom: 20px;
      }

      .step-label {
        display: block;
        font-size: 0.75rem;
        font-weight: 700;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: #64748b;
        margin-bottom: 8px;
        text-align: left;
      }

      .join-input {
        width: 100%;
        padding: 14px 16px;
        border-radius: 12px;
        border: 2px solid rgba(148, 163, 184, 0.3);
        background: rgba(15, 23, 42, 0.8);
        color: #f8fafc;
        font-size: 1rem;
        text-align: center;
        transition: all 0.2s ease;
      }

      .join-input:focus {
        outline: none;
        border-color: #f59e0b;
        box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.2);
      }

      .join-input::placeholder { color: #64748b; }

      /* Team Selection */
      .team-select-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin-bottom: 8px;
      }

      .team-select-btn {
        padding: 12px;
        border-radius: 12px;
        border: 2px solid transparent;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
      }

      .team-select-btn:hover { transform: translateY(-2px); }

      .team-select-btn.selected {
        border-color: #fff !important;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
      }

      .team-select-btn.team-red { background: linear-gradient(135deg, #ef4444, #dc2626); }
      .team-select-btn.team-blue { background: linear-gradient(135deg, #3b82f6, #2563eb); }
      .team-select-btn.team-green { background: linear-gradient(135deg, #22c55e, #16a34a); }
      .team-select-btn.team-purple { background: linear-gradient(135deg, #a855f7, #9333ea); }
      .team-select-btn.team-orange { background: linear-gradient(135deg, #f97316, #ea580c); }
      .team-select-btn.team-pink { background: linear-gradient(135deg, #ec4899, #db2777); }

      .team-select-name {
        font-weight: 700;
        font-size: 0.85rem;
        color: #fff;
      }

      .team-select-count {
        font-size: 0.7rem;
        color: rgba(255, 255, 255, 0.7);
      }

      .no-teams-msg {
        padding: 20px;
        color: #64748b;
        font-size: 0.9rem;
        font-style: italic;
      }

      /* New Team Input */
      .new-team-row {
        display: flex;
        gap: 8px;
        margin-top: 12px;
      }

      .new-team-input {
        flex: 1;
        padding: 10px 12px;
        border-radius: 8px;
        border: 1px solid rgba(148, 163, 184, 0.3);
        background: rgba(15, 23, 42, 0.8);
        color: #f8fafc;
        font-size: 0.85rem;
      }

      .new-team-btn {
        padding: 10px 14px;
        border-radius: 8px;
        border: none;
        background: linear-gradient(135deg, #f59e0b, #d97706);
        color: #fff;
        font-weight: 600;
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.15s ease;
      }

      .new-team-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
      }

      .join-btn {
        width: 100%;
        padding: 16px;
        border-radius: 12px;
        border: none;
        background: linear-gradient(135deg, #22c55e, #16a34a);
        color: #fff;
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.2s ease;
        margin-top: 20px;
      }

      .join-btn:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(34, 197, 94, 0.3);
      }

      .join-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .join-error {
        color: #f87171;
        font-size: 0.85rem;
        margin-top: 12px;
        min-height: 20px;
      }

      .back-link {
        display: inline-block;
        margin-top: 16px;
        color: #64748b;
        font-size: 0.85rem;
        text-decoration: none;
        transition: color 0.15s ease;
      }

      .back-link:hover { color: #94a3b8; }
    </style>
  </head>
  <body>
    <!-- Join Overlay -->
    <div id="joinOverlay" class="join-overlay">
      <div class="join-card">
        <div class="join-title">üë• Team beitreten</div>
        <div class="join-subtitle">W√§hle dein Team und gib deinen Namen ein</div>

        <div class="join-step">
          <span class="step-label">1. Dein Name</span>
          <input type="text" id="playerNameInput" class="join-input" placeholder="Dein Name" maxlength="20" />
        </div>

        <div class="join-step">
          <span class="step-label">2. Team w√§hlen</span>
          <div id="teamSelectGrid" class="team-select-grid">
            <div class="no-teams-msg">Warte auf Teams vom Host...</div>
          </div>
          <div class="new-team-row">
            <input type="text" id="newTeamInput" class="new-team-input" placeholder="Neues Team erstellen..." maxlength="20" />
            <button id="newTeamBtn" class="new-team-btn">+</button>
          </div>
        </div>

        <button id="joinBtn" class="join-btn" disabled>üéÆ Beitreten</button>
        <div id="joinError" class="join-error"></div>

        <a href="/jeopardy-teams.html" class="back-link">‚Üê Zur√ºck zur Auswahl</a>
      </div>
    </div>

    <!-- Main Buzzer View -->
    <header class="buzzer-header hidden" id="buzzerHeader">
      <div class="player-info">
        <span id="teamBadge" class="team-badge team-blue">Team</span>
        <span id="playerNameDisplay" class="player-name">Spieler</span>
      </div>
      <button id="leaveBtn" class="back-btn">Verlassen</button>
    </header>

    <main class="buzzer-main hidden" id="buzzerMain">
      <button id="buzzerButton" class="buzzer-button buzzer-locked" disabled>
        <span class="buzzer-text">GESPERRT</span>
        <span class="buzzer-subtext">Warte auf Freigabe</span>
      </button>
    </main>

    <footer class="status-bar hidden" id="statusBar">
      <div id="statusText" class="status-text">Verbinde...</div>
    </footer>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/player-teams.js"></script>
  </body>
</html>
